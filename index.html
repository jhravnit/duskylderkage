<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kage Awareness + Kage-Invaders</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#111;color:#fff}
    .wrap{max-width:1200px;margin:auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:center;
      background:#222;padding:10px 16px;border-radius:10px}
    .grid{display:grid;gap:20px;grid-template-columns:1fr 1fr;margin-top:20px}
    .card{background:#222;border-radius:14px;padding:20px}
    .btn{background:#0a84ff;color:#fff;padding:12px 16px;border-radius:12px;
      border:0;font-weight:600;cursor:pointer}
    figure{margin:0}
    img{width:100%;display:block;border-radius:12px}
    .canvas-frame{position:relative;border-radius:12px;overflow:hidden;border:1px solid #333}
    canvas{display:block;width:100%;height:100%}
    .overlay{position:absolute;inset:0;display:none;place-items:center;
      background:rgba(0,0,0,.65);color:#fff;font-size:20px;text-align:center}
    .overlay.show{display:grid}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>ğŸ”’ Awareness â€¢ IT-sikkerhed</div>
      <span>jh@ravnit.dk</span>
    </header>

    <div class="grid">
      <!-- Venstre: budskab -->
      <main class="card">
        <h1>ğŸ‘‰ Heldigvis var dette kun en test â€¦ men du skylder nu kage ğŸ°</h1>
        <div style="margin:16px 0">
          <button id="cakeBtn" class="btn">Tryk pÃ¥ mig for kage</button>
        </div>
        <figure>
          <img src="kage.png" alt="Kage"/>
        </figure>
      </main>

      <!-- HÃ¸jre: spil -->
      <aside class="card">
        <h2>ğŸ° Kage-Invaders</h2>
        <div class="canvas-frame">
          <canvas id="game" width="600" height="380"></canvas>
          <div id="overlay" class="overlay">
            <div>
              <div style="font-weight:700;margin-bottom:8px">SÃ¥ der taber kage til alle ğŸ‚</div>
              <div>Klik for ny kage-omgang</div>
            </div>
          </div>
        </div>
        <p>Styring: BevÃ¦g musen â–¸ klik for at skyde</p>
        <p>Score: <span id="score">0</span> | Level: <span id="level">1</span> | Liv: <span id="lives">3</span></p>
      </aside>
    </div>
  </div>

<script>
/* ---- Mail knap ---- */
document.getElementById('cakeBtn').addEventListener('click',()=>{
  const subject="Awareness test: Jeg skylder kage";
  const body="Hej,\n\nJeg klikkede pÃ¥ linket i awareness-testen og skylder kage. ğŸ°\n\nHilsen\n";
  const mailto=`mailto:jh@ravnit.dk?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  window.location.href=mailto;
});

/* ---- Kage-Invaders ---- */
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const overlay=document.getElementById('overlay');

const state={running:false,gameOver:false,score:0,level:1,lives:3,
  player:{x:280,y:340,w:40,h:12},bullets:[],enemies:[],enemyDir:1,speed:0.35};

function resetGame(){
  state.running=true; state.gameOver=false;
  state.score=0; state.level=1; state.lives=3;
  state.bullets=[]; spawnWave(); overlay.classList.remove('show');
  requestAnimationFrame(loop);
}
function spawnWave(){
  state.enemies=[];
  for(let r=0;r<3;r++)for(let c=0;c<6;c++){
    state.enemies.push({x:50+c*70,y:30+r*50,w:34,h:28,hp:1});
  }
}
spawnWave();

let mouseX=canvas.width/2;
canvas.addEventListener('mousemove',e=>{
  const rect=canvas.getBoundingClientRect();
  mouseX=e.clientX-rect.left;
});
canvas.addEventListener('click',()=>{
  if(state.gameOver){resetGame();return;}
  state.bullets.push({x:state.player.x+state.player.w/2-2,y:state.player.y-10,w:4,h:10,vy:-6});
});

function loop(){
  if(!state.running)return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // player
  state.player.x+= (mouseX-state.player.x-state.player.w/2)*0.2;
  ctx.fillStyle="#fff"; ctx.fillRect(state.player.x,state.player.y,state.player.w,state.player.h);

  // bullets
  state.bullets.forEach(b=>{b.y+=b.vy; ctx.fillStyle="#0af"; ctx.fillRect(b.x,b.y,b.w,b.h);});
  state.bullets=state.bullets.filter(b=>b.y>-20);

  // enemies
  const speed=state.speed+(state.level-1)*0.1;
  let minX=9999,maxX=-9999;
  state.enemies.forEach(e=>{
    ctx.font="24px serif"; ctx.fillText("ğŸ°",e.x,e.y);
    e.x+=state.enemyDir*speed;
    minX=Math.min(minX,e.x); maxX=Math.max(maxX,e.x+e.w);
  });
  if(maxX>canvas.width-20)state.enemyDir=-1;
  if(minX<20)state.enemyDir=1;

  // collisions
  state.bullets.forEach(b=>{
    state.enemies.forEach(e=>{
      if(b.x<e.x+e.w && b.x+b.w>e.x && b.y<e.y+e.h && b.y+b.h>e.y){
        e.hp=0; b.y=-9999; state.score+=10;
      }
    });
  });
  state.enemies=state.enemies.filter(e=>e.hp>0);

  // lose check
  if(state.enemies.some(e=>e.y+e.h>=state.player.y)){
    state.lives--;
    if(state.lives<=0){gameOver(); return;} else spawnWave();
  }

  // next level
  if(state.enemies.length===0){state.level++; spawnWave();}

  // HUD
  document.getElementById('score').textContent=state.score;
  document.getElementById('level').textContent=state.level;
  document.getElementById('lives').textContent=state.lives;

  requestAnimationFrame(loop);
}

function gameOver(){
  state.running=false; state.gameOver=true;
  overlay.classList.add('show');
}

resetGame();
</script>
</body>
</html>
